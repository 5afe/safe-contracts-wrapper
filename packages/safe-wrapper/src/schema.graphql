#import { Module } into SafeContracts from "wrap://ipfs/QmXuSErK5jEt9tm9jzz8fJdTKoHrjoTbr8h2b2SLnVe6qw"
#import { Module, Connection, TxOverrides, TxReceipt, TypedDataDomain, TypedDataType, TypedDataValue } into Ethereum from "wrap://ens/ethereum.polywrap.eth"
#import { Module } into Logger from "wrap://ens/js-logger.polywrap.eth"

type Env {
    safeAddress: String!
    connection: Ethereum_Connection!
}

type SafeTransaction {
    signatures: Map @annotate(type: "Map<String!, SignSignature!>")
    data: SafeTransactionData!
}

type MetaTransactionData {
    data: String!
    to: String!
    value: String!
    operation: BigInt
}

type SafeTransactionOptionalProps {
    operation: BigInt
    safeTxGas: BigInt
    baseGas: BigInt
    gasPrice: BigInt
    gasToken: String
    refundReceiver: String
    nonce: BigInt
}

type SafeTransactionData {
    data: String!
    to: String!
    value: String!
    operation: BigInt
    safeTxGas: BigInt
    baseGas: BigInt
    gasPrice: BigInt
    gasToken: String
    refundReceiver: String
    nonce: BigInt
    # TODO: add txOverrides
}

type SignSignature {
    signer: String!
    data: String!
}

type Module {
    """Owner manager methods"""
    getOwners: [String!]! @env(required: true)
    getThreshold: UInt32! @env(required: true)
    isOwner(ownerAddress: String!): Boolean! @env(required: true)
    encodeAddOwnerWithThresholdData(ownerAddress: String!, threshold: UInt32): String! @env(required: true)
    encodeRemoveOwnerData(ownerAddress: String!, threshold: UInt32): String! @env(required: true)
    encodeSwapOwnerData(oldOwnerAddress: String!, newOwnerAddress: String!): String! @env(required: true)
    encodeChangeThresholdData(threshold: UInt32!): String! @env(required: true)

    """Module manager methods"""
    getModules: [String!]! @env(required: true)
    isModuleEnabled(moduleAddress: String!): Boolean! @env(required: true)
    encodeEnableModuleData(moduleAddress: String!): String! @env(required: true)
    encodeDisableModuleData(moduleAddress: String!): String! @env(required: true)

    """Transaction manager methods"""
    createTransaction(tx: SafeTransactionData!, options: SafeTransactionOptionalProps): SafeTransaction! @env(required: true)
    createMultiSendTransaction(txs: [SafeTransactionData!]!, options: SafeTransactionOptionalProps, onlyCalls: Boolean, customMultiSendContractAddress: String ): SafeTransaction! @env(required: true)
    addSignature(tx: SafeTransaction!): SafeTransaction! @env(required: true)
    getTransactionHash(tx: SafeTransactionData!): String @env(required: true)
    signTransactionHash(hash: String!): SignSignature! @env(required: true)
    signTypedData(domain: Ethereum_TypedDataDomain!, types: [Ethereum_TypedDataType!]!, value: [Ethereum_TypedDataValue!]!): String! @env(required: true)

    """Contract manager methods"""
    # contractNetworks()
    # isL1SafeMasterCopy()
    # safeContract()
    # multiSendContract()
    # multiSendCallOnlyContract()
    getSafeVersion: String! @env(required: true)
    getMultiSendContract: String! @env(required: true)
}
